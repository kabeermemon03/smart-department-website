<div class="admin-page">
  <!-- Login Section -->
  <div class="login-section" *ngIf="!isLoggedIn">
    <div class="container">
      <div class="login-card">
        <div class="login-header">
          <h2>üîê Admin Panel</h2>
          <p>Faculty Login Required</p>
        </div>
        <form (ngSubmit)="login()" class="login-form">
          <div class="form-group">
            <label for="username">Username</label>
            <input 
              type="text" 
              id="username" 
              [(ngModel)]="loginForm.username" 
              name="username" 
              required
              placeholder="Enter username">
          </div>
          <div class="form-group">
            <label for="password">Password</label>
            <input 
              type="password" 
              id="password" 
              [(ngModel)]="loginForm.password" 
              name="password" 
              required
              placeholder="Enter password">
          </div>
          <button type="submit" class="login-btn">Login</button>
        </form>
        <div class="demo-credentials">
          <p><small>Teacher: <strong>teacher@esmuet.edu.pk</strong> (password: esmuet1972)</small></p>
          <p><small>Student Admin: <strong>student@esmuet.edu.pk</strong> (password: newsadmin2024)</small></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Admin Dashboard -->
  <div class="admin-dashboard" *ngIf="isLoggedIn">
    <div class="dashboard-header">
      <div class="container">
        <div class="header-content">
          <div class="header-info">
            <h1>üìä Admin Dashboard</h1>
            <p class="user-role">Logged in as: <strong>{{ userRole === 'teacher' ? 'Teacher Admin' : 'Student Admin' }}</strong></p>
            <div class="auth-status">
              <span class="status-indicator" [class.signed-in]="isLoggedIn">
                {{ isLoggedIn ? '‚úÖ Signed In' : '‚ùå Not Signed In' }}
              </span>
            </div>
          </div>
          <button (click)="logout()" class="logout-btn">Logout</button>
        </div>
      </div>
    </div>

    <div class="dashboard-content">
      <div class="container">
        <!-- Results Management (Teachers Only) -->
        <div *ngIf="canManageResults()">
          <!-- Upload Section -->
          <div class="upload-section">
            <h2>üì§ Upload Result PDF</h2>
            <form (ngSubmit)="uploadResult()" class="upload-form">
              <div class="form-row">
                <div class="form-group">
                  <label for="semester">Semester</label>
                  <select id="semester" [(ngModel)]="uploadForm.semester" name="semester" required>
                    <option value="">Select Semester</option>
                    <option value="1">Semester 1</option>
                    <option value="2">Semester 2</option>
                    <option value="3">Semester 3</option>
                    <option value="4">Semester 4</option>
                    <option value="5">Semester 5</option>
                    <option value="6">Semester 6</option>
                    <option value="7">Semester 7</option>
                    <option value="8">Semester 8</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="course">Course</label>
                  <select id="course" [(ngModel)]="uploadForm.course" name="course" required>
                    <option value="">Select Course</option>
                    <option value="Electronics Engineering">Electronics Engineering</option>
                    <option value="Computer Engineering">Computer Engineering</option>
                    <option value="Electrical Engineering">Electrical Engineering</option>
                  </select>
                </div>
              </div>
              <div class="form-group">
                <label for="title">Result Title</label>
                <input
                  type="text"
                  id="title"
                  [(ngModel)]="uploadForm.title"
                  name="title"
                  required
                  placeholder="e.g., Final Exam Results - Spring 2024">
              </div>
              <div class="form-group">
                <label for="file">PDF File</label>
                <input
                  type="file"
                  id="file"
                  (change)="onFileSelect($event)"
                  accept=".pdf"
                  required>
              </div>
              <button type="submit" class="upload-btn">Upload Result</button>
            </form>
          </div>

          <!-- Uploaded Results Management -->
          <div class="results-management">
            <h2>üìã Manage Uploaded Results</h2>
            <div class="results-table" *ngIf="uploadedResults.length > 0; else noResults">
              <div class="table-header">
                <div class="col">Title</div>
                <div class="col">Semester</div>
                <div class="col">Course</div>
                <div class="col">Upload Date</div>
                <div class="col">Actions</div>
              </div>
              <div class="table-row" *ngFor="let result of uploadedResults">
                <div class="col">{{ result.title }}</div>
                <div class="col">Semester {{ result.semester }}</div>
                <div class="col">{{ result.course }}</div>
                <div class="col">{{ result.uploadDate }}</div>
                <div class="col">
                  <button (click)="deleteResult(result.id)" class="delete-btn">üóëÔ∏è Delete</button>
                </div>
              </div>
            </div>
            <ng-template #noResults>
              <div class="no-results">
                <p>No results uploaded yet.</p>
              </div>
            </ng-template>
          </div>
        </div>

        <!-- News Management (Teachers and Students) -->
        <div *ngIf="canManageNews()" class="news-management">
          <h2>üì∞ Manage News & Announcements</h2>

          <!-- Add New Notice Form -->
          <div class="add-notice-section">
            <h3>‚ûï Add New Notice</h3>
            <form (ngSubmit)="addNotice()" class="notice-form">
              <div class="form-row">
                <div class="form-group">
                  <label for="notice-title">Title</label>
                  <input
                    type="text"
                    id="notice-title"
                    [(ngModel)]="noticeForm.title"
                    name="title"
                    required
                    placeholder="Notice title">
                </div>
                <div class="form-group">
                  <label for="category">Category</label>
                  <select id="category" [(ngModel)]="noticeForm.category" name="category" required>
                    <option value="news">News</option>
                    <option value="announcements">Announcement</option>
                    <option value="events">Event</option>
                    <option value="academic">Academic</option>
                  </select>
                </div>
              </div>
              <div class="form-group">
                <label for="excerpt">Excerpt</label>
                <textarea
                  id="excerpt"
                  [(ngModel)]="noticeForm.excerpt"
                  name="excerpt"
                  required
                  placeholder="Brief description..."
                  rows="3"></textarea>
              </div>
              <div class="form-group">
                <label for="eventName">Event Name</label>
                <input
                  type="text"
                  id="eventName"
                  [(ngModel)]="noticeForm.eventName"
                  name="eventName"
                  placeholder="Event name (optional)">
              </div>
              <div class="form-group">
                <label for="description">Description</label>
                <textarea
                  id="description"
                  [(ngModel)]="noticeForm.description"
                  name="description"
                  placeholder="Detailed description..."
                  rows="3"></textarea>
              </div>
              <div class="form-group">
                <label for="link">Link</label>
                <input
                  type="url"
                  id="link"
                  [(ngModel)]="noticeForm.link"
                  name="link"
                  placeholder="https://example.com">
              </div>
              <div class="form-group">
                <label for="content">Full Content (Optional)</label>
                <textarea
                  id="content"
                  [(ngModel)]="noticeForm.content"
                  name="content"
                  placeholder="Detailed content..."
                  rows="5"></textarea>
              </div>
              <div class="form-row">
                <div class="form-group checkbox-group">
                  <label class="checkbox-label">
                    <input type="checkbox" [(ngModel)]="noticeForm.urgent" name="urgent">
                    <span>Urgent</span>
                  </label>
                </div>
                <div class="form-group checkbox-group">
                  <label class="checkbox-label">
                    <input type="checkbox" [(ngModel)]="noticeForm.featured" name="featured">
                    <span>Featured</span>
                  </label>
                </div>
              </div>
              <button type="submit" class="add-notice-btn">Add Notice</button>
            </form>
          </div>

          <!-- Existing Notices Management -->
          <div class="notices-list">
            <h3>üìã Existing Notices</h3>
            <div class="notices-table" *ngIf="notices.length > 0; else noNotices">
              <div class="table-header">
                <div class="col">Title</div>
                <div class="col">Category</div>
                <div class="col">Date</div>
                <div class="col">Status</div>
                <div class="col">Actions</div>
              </div>
              <div class="table-row" *ngFor="let notice of notices">
                <div class="col">{{ notice.title }}</div>
                <div class="col">{{ notice.category }}</div>
                <div class="col">{{ notice.date }}</div>
                <div class="col">
                  <span class="status-badge" [class.urgent]="notice.urgent" [class.featured]="notice.featured">
                    {{ notice.urgent ? 'Urgent' : notice.featured ? 'Featured' : 'Normal' }}
                  </span>
                </div>
                <div class="col">
                  <button (click)="deleteNotice(notice.id)" class="delete-btn">üóëÔ∏è Delete</button>
                </div>
              </div>
            </div>
            <ng-template #noNotices>
              <div class="no-results">
                <p>No notices created yet.</p>
              </div>
            </ng-template>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>