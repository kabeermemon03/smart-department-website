<div class="admin-page">
  <!-- Login Section -->
  <div class="login-section" *ngIf="!isLoggedIn">
    <div class="container">
      <div class="login-card">
        <div class="login-header">
          <h2>ğŸ” Admin Panel</h2>
          <p>Faculty Login Required</p>
        </div>
        <form (ngSubmit)="login()" class="login-form">
          <div class="form-group">
            <label for="username">Username</label>
            <input 
              type="text" 
              id="username" 
              [(ngModel)]="loginForm.username" 
              name="username" 
              required
              placeholder="Enter username">
          </div>
          <div class="form-group">
            <label for="password">Password</label>
            <input 
              type="password" 
              id="password" 
              [(ngModel)]="loginForm.password" 
              name="password" 
              required
              placeholder="Enter password">
          </div>
          <button type="submit" class="login-btn">Login</button>
        </form>
        <div class="demo-credentials" style="display: none;">
          <!-- Credentials removed for production -->
        </div>
      </div>
    </div>
  </div>

  <!-- Admin Dashboard -->
  <div class="admin-dashboard" *ngIf="isLoggedIn">
    <div class="dashboard-header">
      <div class="container">
        <div class="header-content">
          <div class="header-info">
            <h1>ğŸ“Š Admin Dashboard</h1>
            <p class="user-role">Logged in as: <strong>{{ userRole === 'teacher' ? 'Teacher Admin' : 'Student Admin' }}</strong></p>
            <div class="auth-status">
              <span class="status-indicator" [class.signed-in]="isLoggedIn">
                {{ isLoggedIn ? 'âœ… Signed In' : 'âŒ Not Signed In' }}
              </span>
            </div>
            <div class="permissions-info">
              <div class="permission-badge" *ngIf="canManageResults()">
                <span class="badge-icon">ğŸ“¤</span>
                <span>PDF Upload Access</span>
              </div>
              <div class="permission-badge" *ngIf="canManageNews()">
                <span class="badge-icon">ğŸ“°</span>
                <span>News Management</span>
              </div>
            </div>
          </div>
          <div class="header-actions">
            <button (click)="logout()" class="logout-btn">
              <span class="btn-icon">ğŸšª</span>
              <span>Logout</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="dashboard-content">
      <div class="container">
        <!-- Quick Stats -->
        <div class="stats-section">
          <div class="stats-grid">
            <div class="stat-card" *ngIf="canManageResults()">
              <div class="stat-icon">ğŸ“Š</div>
              <div class="stat-info">
                <h3>{{ uploadedResults.length }}</h3>
                <p>Uploaded Results</p>
              </div>
            </div>
            <div class="stat-card" *ngIf="canManageNews()">
              <div class="stat-icon">ğŸ“°</div>
              <div class="stat-info">
                <h3>{{ notices.length }}</h3>
                <p>Published News</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">ğŸ‘¤</div>
              <div class="stat-info">
                <h3>{{ userRole === 'teacher' ? 'Teacher' : 'Student' }}</h3>
                <p>Access Level</p>
              </div>
            </div>
          </div>
        </div>
        <!-- Results Management (Teachers Only) -->
        <div class="section-wrapper" *ngIf="canManageResults()">
          <div class="section-header-banner">
            <h2>ğŸ“Š Teacher Dashboard - Results Management</h2>
            <p>Upload and manage examination results for students</p>
          </div>
          
          <!-- Upload Section -->
          <div class="upload-section">
            <div class="section-title">
              <span class="title-icon">ğŸ“¤</span>
              <h3>Upload Result PDF</h3>
            </div>
            <form (ngSubmit)="uploadResult()" class="upload-form">
              <div class="form-row">
                <div class="form-group">
                  <label for="semester">Semester</label>
                  <select id="semester" [(ngModel)]="uploadForm.semester" name="semester" required>
                    <option value="">Select Semester</option>
                    <option value="1">Semester 1</option>
                    <option value="2">Semester 2</option>
                    <option value="3">Semester 3</option>
                    <option value="4">Semester 4</option>
                    <option value="5">Semester 5</option>
                    <option value="6">Semester 6</option>
                    <option value="7">Semester 7</option>
                    <option value="8">Semester 8</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="course">Course</label>
                  <select id="course" [(ngModel)]="uploadForm.course" name="course" required>
                    <option value="">Select Course</option>
                    <option value="Electronics Engineering">Electronics Engineering</option>
                    <option value="Computer Engineering">Computer Engineering</option>
                    <option value="Electrical Engineering">Electrical Engineering</option>
                  </select>
                </div>
              </div>
              <div class="form-group">
                <label for="title">Result Title</label>
                <input
                  type="text"
                  id="title"
                  [(ngModel)]="uploadForm.title"
                  name="title"
                  required
                  placeholder="e.g., Final Exam Results - Spring 2024">
              </div>
              <div class="form-group">
                <label for="file">PDF File</label>
                <div class="file-upload-area">
                  <input
                    type="file"
                    id="file"
                    (change)="onFileSelect($event)"
                    accept=".pdf"
                    required>
                  <div class="file-upload-text">
                    <span class="upload-icon">ğŸ“</span>
                    <span>Click to select PDF file or drag and drop</span>
                  </div>
                </div>
              </div>
              <button type="submit" class="upload-btn">
                <span class="btn-icon">â¬†ï¸</span>
                <span>Upload Result</span>
              </button>
            </form>
          </div>

          <!-- Uploaded Results Management -->
          <div class="results-management">
            <div class="section-title">
              <span class="title-icon">ğŸ“‹</span>
              <h3>Manage Uploaded Results</h3>
            </div>
            <div class="results-table" *ngIf="uploadedResults.length > 0; else noResults">
              <div class="table-header">
                <div class="col">Title</div>
                <div class="col">Semester</div>
                <div class="col">Course</div>
                <div class="col">Upload Date</div>
                <div class="col">Actions</div>
              </div>
              <div class="table-row" *ngFor="let result of uploadedResults">
                <div class="col">{{ result.title }}</div>
                <div class="col">Semester {{ result.semester }}</div>
                <div class="col">{{ result.course }}</div>
                <div class="col">{{ result.uploadDate }}</div>
                <div class="col">
                  <button (click)="deleteResult(result.id)" class="delete-btn">
                    <span>ğŸ—‘ï¸</span>
                    <span>Delete</span>
                  </button>
                </div>
              </div>
            </div>
            <ng-template #noResults>
              <div class="no-results">
                <div class="no-results-icon">ğŸ“„</div>
                <h4>No results uploaded yet</h4>
                <p>Upload your first PDF result using the form above</p>
              </div>
            </ng-template>
          </div>
        </div>

        <!-- News Management (Teachers and Students) -->
        <div class="section-wrapper" *ngIf="canManageNews()">
          <div class="section-header-banner">
            <h2>ğŸ“° {{ userRole === 'teacher' ? 'Teacher' : 'Student' }} Dashboard - News Management</h2>
            <p>Create and manage department news, announcements, and events</p>
          </div>

          <!-- Add New Notice Form -->
          <div class="add-notice-section">
            <div class="section-title">
              <span class="title-icon">â•</span>
              <h3>Add New Notice</h3>
            </div>
            <form (ngSubmit)="addNotice()" class="notice-form">
              <div class="form-row">
                <div class="form-group">
                  <label for="notice-title">Title</label>
                  <input
                    type="text"
                    id="notice-title"
                    [(ngModel)]="noticeForm.title"
                    name="title"
                    required
                    placeholder="Enter notice title">
                </div>
                <div class="form-group">
                  <label for="category">Category</label>
                  <select id="category" [(ngModel)]="noticeForm.category" name="category" required>
                    <option value="news">ğŸ“° News</option>
                    <option value="announcements">ğŸ“¢ Announcement</option>
                    <option value="events">ğŸ‰ Event</option>
                    <option value="academic">ğŸ“ Academic</option>
                  </select>
                </div>
              </div>
              <div class="form-group">
                <label for="excerpt">Excerpt</label>
                <textarea
                  id="excerpt"
                  [(ngModel)]="noticeForm.excerpt"
                  name="excerpt"
                  required
                  placeholder="Brief description (will be shown in preview)"
                  rows="3"></textarea>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label for="eventName">Event Name (Optional)</label>
                  <input
                    type="text"
                    id="eventName"
                    [(ngModel)]="noticeForm.eventName"
                    name="eventName"
                    placeholder="Event name if applicable">
                </div>
                <div class="form-group">
                  <label for="link">Link (Optional)</label>
                  <input
                    type="url"
                    id="link"
                    [(ngModel)]="noticeForm.link"
                    name="link"
                    placeholder="https://example.com">
                </div>
              </div>
              <div class="form-group">
                <label for="description">Description</label>
                <textarea
                  id="description"
                  [(ngModel)]="noticeForm.description"
                  name="description"
                  placeholder="Detailed description of the notice"
                  rows="4"></textarea>
              </div>
              <div class="form-group">
                <label for="content">Full Content (Optional)</label>
                <textarea
                  id="content"
                  [(ngModel)]="noticeForm.content"
                  name="content"
                  placeholder="Complete article content (for detailed news)"
                  rows="6"></textarea>
              </div>
              <div class="form-row">
                <div class="form-group checkbox-group">
                  <label class="checkbox-label">
                    <input type="checkbox" [(ngModel)]="noticeForm.urgent" name="urgent">
                    <span class="checkmark"></span>
                    <span>ğŸ”´ Mark as Urgent</span>
                  </label>
                </div>
                <div class="form-group checkbox-group">
                  <label class="checkbox-label">
                    <input type="checkbox" [(ngModel)]="noticeForm.featured" name="featured">
                    <span class="checkmark"></span>
                    <span>â­ Mark as Featured</span>
                  </label>
                </div>
              </div>
              <button type="submit" class="add-notice-btn">
                <span class="btn-icon">ğŸ“¤</span>
                <span>Publish Notice</span>
              </button>
            </form>
          </div>

          <!-- Existing Notices Management -->
          <div class="notices-list">
            <div class="section-title">
              <span class="title-icon">ğŸ“‹</span>
              <h3>Published Notices ({{ notices.length }})</h3>
            </div>
            <div class="notices-table" *ngIf="notices.length > 0; else noNotices">
              <div class="table-header">
                <div class="col">Title</div>
                <div class="col">Category</div>
                <div class="col">Date</div>
                <div class="col">Status</div>
                <div class="col">Actions</div>
              </div>
              <div class="table-row" *ngFor="let notice of notices">
                <div class="col">
                  <div class="notice-title">
                    <span>{{ notice.title }}</span>
                    <small>{{ notice.excerpt | slice:0:50 }}{{ notice.excerpt?.length > 50 ? '...' : '' }}</small>
                  </div>
                </div>
                <div class="col">
                  <span class="category-badge" [class]="notice.category">
                    {{ getCategoryIcon(notice.category) }} {{ notice.category | titlecase }}
                  </span>
                </div>
                <div class="col">{{ notice.date }}</div>
                <div class="col">
                  <span class="status-badge" [class.urgent]="notice.urgent" [class.featured]="notice.featured">
                    {{ notice.urgent ? 'ğŸ”´ Urgent' : notice.featured ? 'â­ Featured' : 'ğŸŸ¢ Normal' }}
                  </span>
                </div>
                <div class="col">
                  <button (click)="deleteNotice(notice.id)" class="delete-btn">
                    <span>ğŸ—‘ï¸</span>
                    <span>Delete</span>
                  </button>
                </div>
              </div>
            </div>
            <ng-template #noNotices>
              <div class="no-results">
                <div class="no-results-icon">ğŸ“°</div>
                <h4>No notices published yet</h4>
                <p>Create your first notice using the form above</p>
              </div>
            </ng-template>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>